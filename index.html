<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>بوابة الدخول</title>

  <!-- ألوان وخطوط -->
  <style>
    :root{
      --bg: #000000;
      --matrix-green: #00ff7b;   /* أخضر مشع */
      --matrix-dim: #0a3;        /* أخضر خافت */
      --text: #d8ffd8;
      --accent: #00c26a;
      --input-bg: rgba(0,0,0,0.6);
      --input-border: rgba(0,255,123,0.35);
      --card-bg: rgba(0, 10, 0, 0.55);
      --shadow: 0 0 32px rgba(0,255,123,0.25), inset 0 0 12px rgba(0,255,123,0.2);
    }

    /* إعادة تعيين أساسية */
    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body {
      margin: 0;
      background: var(--bg);
      color: var(--text);
      font-family: "Cairo", "Amiri", "Tajawal", system-ui, sans-serif;
      overflow: hidden; /* نمنع التمرير لأن الخلفية فُل-سكرين */
    }

    /* طبقات الصفحة */
    .matrix-canvas {
      position: fixed;
      inset: 0;
      z-index: 0;
      background: #000;
    }

    .page {
      position: relative;
      z-index: 1;
      display: grid;
      grid-template-rows: auto 1fr auto;
      min-height: 100vh;
      padding: 16px;
      gap: 16px;
    }

    /* منطقة الشعار */
    .header {
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 8px 12px;
    }
    .logo {
      width: clamp(120px, 30vw, 220px);
      height: clamp(40px, 10vw, 72px);
      border: 1.5px dashed var(--matrix-dim);
      border-radius: 10px;
      color: var(--matrix-green);
      display: grid;
      place-items: center;
      text-shadow: 0 0 8px var(--matrix-green);
      user-select: none;
    }

    /* منطقة المحتوى الأوسط */
    .center {
      display: grid;
      place-items: center;
      padding: 8px;
    }

    .login-card {
      width: min(92vw, 460px);
      background: var(--card-bg);
      border: 1px solid var(--matrix-dim);
      border-radius: 14px;
      box-shadow: var(--shadow);
      backdrop-filter: blur(6px);
      padding: 18px 16px;
      display: grid;
      gap: 14px;
    }

    .login-title {
      margin: 0;
      font-size: clamp(18px, 4vw, 22px);
      color: var(--matrix-green);
      letter-spacing: 0.8px;
      text-shadow: 0 0 8px rgba(0,255,123,0.6);
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .form {
      display: grid;
      gap: 12px;
    }

    .field {
      display: grid;
      gap: 6px;
    }

    .label {
      font-size: 14px;
      color: #9fffbf;
      letter-spacing: 0.4px;
    }

    .input {
      width: 100%;
      padding: 12px 14px;
      border-radius: 10px;
      background: var(--input-bg);
      border: 1.5px solid var(--input-border);
      color: var(--text);
      outline: none;
      caret-color: var(--matrix-green);
      box-shadow: inset 0 0 10px rgba(0,255,123,0.12);
      transition: border-color 0.2s, box-shadow 0.2s;
      font-family: inherit;
    }
    .input:focus {
      border-color: var(--matrix-green);
      box-shadow: inset 0 0 14px rgba(0,255,123,0.18);
    }

    .actions {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 8px;
      margin-top: 4px;
    }

    .remember {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      color: #9fffbf;
      font-size: 14px;
      user-select: none;
    }
    .remember input { accent-color: var(--accent); }

    .btn {
      padding: 10px 16px;
      border-radius: 10px;
      border: 1.5px solid var(--matrix-green);
      color: var(--bg);
      background: var(--matrix-green);
      font-weight: 600;
      letter-spacing: 0.4px;
      cursor: pointer;
      transition: transform 0.08s ease, box-shadow 0.15s ease;
      box-shadow: 0 0 12px rgba(0,255,123,0.35);
    }
    .btn:hover { transform: translateY(-1px); }
    .btn:active { transform: translateY(0); }

    .hint {
      font-size: 12.5px;
      color: #88ffb2;
      line-height: 1.5;
    }

    /* الرسالة السفلية بخط “ماتركسي” عربي */
    .footer {
      padding: 8px;
    }
    .message-card {
      width: min(94vw, 820px);
      margin: 0 auto;
      background: linear-gradient(180deg, rgba(0,10,0,0.45), rgba(0,20,0,0.55));
      border: 1px solid var(--matrix-dim);
      border-radius: 12px;
      box-shadow: var(--shadow);
      padding: 14px 16px;
    }
    .matrix-arabic {
      /* طابع ماتركس عربي: مسافات ثابتة، تباعد بسيط، توهج أخضر */
      font-family: "Amiri", "Cairo", monospace;
      font-size: clamp(14px, 2.8vw, 18px);
      letter-spacing: 1px;
      line-height: 1.8;
      color: var(--matrix-green);
      text-shadow: 0 0 6px rgba(0,255,123,0.55), 0 0 18px rgba(0,255,123,0.25);
      direction: rtl;
      white-space: pre-wrap;
      user-select: none;
    }

    /* شاشات أكبر: تكبير بسيط للمسافات */
    @media (min-width: 768px){
      .login-card { padding: 22px 18px; gap: 16px; }
      .actions .btn { padding: 12px 18px; }
    }
  </style>
</head>
<body>

  <!-- خلفية ماتركس (كانفاس) -->
  <canvas class="matrix-canvas" id="matrix"></canvas>

  <!-- المحتوى -->
  <main class="page" aria-label="بوابة الدخول">

    <!-- مساحة الشعار -->
    <header class="header">
      <div class="logo" aria-label="مساحة الشعار">
        الشعار هنا
      </div>
    </header>

    <!-- نموذج الدخول -->
    <section class="center">
      <form class="login-card" id="loginForm" autocomplete="on">
        <h2 class="login-title">تسجيل الدخول</h2>

        <div class="form">
          <div class="field">
            <label class="label" for="username">اسم المستخدم</label>
            <input class="input" id="username" name="username" type="text" inputmode="text"
                   placeholder="اكتب اسم المستخدم" required />
          </div>

          <div class="field">
            <label class="label" for="password">كلمة المرور</label>
            <input class="input" id="password" name="password" type="password"
                   placeholder="••••••••" required />
          </div>
        </div>

        <div class="actions">
          <label class="remember">
            <input type="checkbox" id="remember" checked />
            تذكرني تلقائياً
          </label>
          <button class="btn" type="submit">دخول</button>
        </div>

        <p class="hint">
          ملاحظة: الحفظ التلقائي هنا تجريبي للواجهة الأمامية. يُستبدل لاحقاً بتوكن آمن من الخادم.
        </p>
      </form>
    </section>

    <!-- الرسالة السفلية -->
    <footer class="footer">
      <div class="message-card">
        <div class="matrix-arabic" id="userMessage" aria-live="polite">
          ‎رسالتنا إليك ستظهر هنا بأسلوب عربي ماتركسي…‎
        </div>
      </div>
    </footer>
  </main>

  <!-- سكربت: مطر الرموز + الحفظ التلقائي -->
  <script>
    /*-------------- مطر الرموز العربية (ماتركس) --------------*/
    (function(){
      const canvas = document.getElementById('matrix');
      const ctx = canvas.getContext('2d');

      function resize(){
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
      }
      resize();
      window.addEventListener('resize', resize);

      // مجموعة رموز عربية وعلامات لإحساس “الماتركس”
      const glyphs = "آأبتثجحخدذرزسشصضطظعغفقكلمنهوىي؟؛،ـ﴾﴿⟂";
      const fontSize = Math.max(14, Math.floor(window.innerWidth / 80));
      const columns = Math.ceil(canvas.width / fontSize);
      const drops = Array.from({ length: columns }, () => Math.floor(Math.random() * canvas.height));

      function draw(){
        // مسح بخلفية شفافة لإضافة أثر الذيل
        ctx.fillStyle = "rgba(0, 0, 0, 0.08)";
        ctx.fillRect(0, 0, canvas.width, canvas.height);

        ctx.fillStyle = "#00ff7b";
        ctx.shadowColor = "#00ff7b";
        ctx.shadowBlur = 8;
        ctx.font = `${fontSize}px "Amiri","Cairo",monospace`;

        for(let i = 0; i < drops.length; i++){
          const text = glyphs.charAt(Math.floor(Math.random() * glyphs.length));
          const x = i * fontSize;
          const y = drops[i] * fontSize;

          ctx.fillText(text, x, y);

          // إعادة الضلع للأسفل مع عشوائية
          if(y > canvas.height && Math.random() > 0.975){
            drops[i] = 0;
          } else {
            drops[i]++;
          }
        }
        requestAnimationFrame(draw);
      }
      draw();
    })();

    /*-------------- الحفظ التلقائي للدخول (تجريبي) --------------*/
    (function(){
      const form = document.getElementById('loginForm');
      const username = document.getElementById('username');
      const password = document.getElementById('password');
      const remember = document.getElementById('remember');

      const LS_KEY = "demo_auth_v1";

      // تحميل بيانات محفوظة
      const saved = JSON.parse(localStorage.getItem(LS_KEY) || "null");
      if(saved && saved.username){
        username.value = saved.username;
        // لأغراض العرض: نسمح بدخول تلقائي إن كان remember=true
        if(saved.remember){
          // في تطبيق حقيقي: تحقق من توكن صالح من الخادم بدلاً من هذا
          document.body.dispatchEvent(new CustomEvent("autoLogin", { detail: saved }));
        }
      }

      // إرسال النموذج
      form.addEventListener('submit', (e) => {
        e.preventDefault();

        const data = {
          username: username.value.trim(),
          // لا نخزن كلمة المرور (لغير الآمن). نرسلها للخادم فقط.
          remember: !!remember.checked,
          timestamp: Date.now()
        };

        localStorage.setItem(LS_KEY, JSON.stringify(data));

        // هنا مكان طلب الخادم (fetch/axios) للتحقق الفعلي
        // إن نجح: وجه المستخدم للصفحة الرئيسية
        // للتجربة: نعرض إشعاراً بسيطاً
        alert("تم تسجيل الدخول. (نموذج تجريبي)");

        // مثال توجيه
        // location.href = "/dashboard.html";
      });

      // الدخول التلقائي التجريبي
      document.body.addEventListener("autoLogin", (ev) => {
        const u = ev.detail?.username || "مستخدم";
        // عرض خفيف يدل على الدخول التلقائي
        const msg = document.getElementById('userMessage');
        if(msg){
          msg.textContent = `مرحباً ${u} — تم التعرف عليك تلقائياً.`;
        }
      });
    })();

    /*-------------- تخصيص الرسالة السفلية لاحقاً --------------*/
    // استخدم هذه الدالة لتحديث الرسالة بنفس الأسلوب
    function setUserMessage(text){
      const msg = document.getElementById('userMessage');
      if(msg){
        msg.textContent = text;
      }
    }
    // مثال:
    // setUserMessage("‎أهلاً بك في النظام. اطلع على التعليمات قبل البدء…‎");
  </script>
</body>
</html>
// داخل index.html
form.addEventListener('submit', (e) => {
  e.preventDefault();

  const data = {
    username: username.value.trim(),
    remember: !!remember.checked,
    xp: 0, // مبدئيًا صفر، ويمكنك زيادته لاحقًا
    timestamp: Date.now()
  };

  localStorage.setItem("demo_auth_v1", JSON.stringify(data));

  // التوجيه إلى الصفحة الرئيسية
  window.location.href = "main.html";
});

